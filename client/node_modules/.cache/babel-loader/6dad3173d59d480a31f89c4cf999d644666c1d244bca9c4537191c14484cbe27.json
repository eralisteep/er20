{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\butabayev.yerali\\\\Documents\\\\GitHub\\\\er17\\\\client\\\\src\\\\components\\\\modals\\\\GetResults.js\",\n  _s = $RefreshSig$();\nimport React, { useContext, useEffect, useState } from 'react';\nimport { Modal, Dropdown, Button } from 'react-bootstrap';\nimport axios from 'axios';\nimport { Context } from '../..';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst GetResults = ({\n  show,\n  onHide\n}) => {\n  _s();\n  const [results, setResults] = useState([]);\n  const [statistics, setStatistics] = useState({});\n  const {\n    device\n  } = useContext(Context);\n  useEffect(() => {\n    if (device.selectedDevice.id) {\n      axios.get(`http://localhost:5000/api/testResult?deviceId=${device.selectedDevice.id}`).then(response => {\n        const filteredResults = response.data.filter(result => result.deviceId === device.selectedDevice.id);\n        console.log('Filtered Results:', filteredResults);\n        setResults(filteredResults);\n      }).catch(error => {\n        console.error('There was an error fetching the survey results!', error);\n      });\n    }\n  }, [device.selectedDevice]);\n  useEffect(() => {\n    axios.get('http://localhost:5000/api/device').then(response => {\n      device.setDevices(response.data);\n    }).catch(error => {\n      console.error('There was an error fetching the devices!', error);\n    });\n  }, []);\n  const getStatistics = () => {\n    const stats = {};\n    if (results && Array.isArray(results)) {\n      results.forEach(result => {\n        console.log('Processing result:', result);\n        if (result.answers && typeof result.answers === 'object') {\n          Object.keys(result.answers).forEach(index => {\n            const answer = result.answers[index];\n            if (!stats[index]) {\n              stats[index] = [];\n            }\n            if (Array.isArray(answer)) {\n              answer.forEach(singleAnswer => {\n                stats[index].push({\n                  user: result.userId,\n                  answer: `Вариант ответа ${singleAnswer.replace('description', '')}`\n                });\n              });\n            } else {\n              stats[index].push({\n                user: result.userId,\n                answer: `Вариант ответа ${answer.replace('description', '')}`\n              });\n            }\n          });\n        } else {\n          console.warn('Missing or invalid answers for result:', result);\n        }\n      });\n    }\n    console.log('Calculated Statistics:', stats);\n    setStatistics(stats);\n  };\n  const handleGetStatistics = () => {\n    getStatistics();\n  };\n  useEffect(() => {\n    console.log('Statistics:', statistics);\n  }, [statistics]);\n  return /*#__PURE__*/_jsxDEV(Modal, {\n    show: show,\n    onHide: onHide,\n    children: [/*#__PURE__*/_jsxDEV(Dropdown, {\n      children: [/*#__PURE__*/_jsxDEV(Dropdown.Toggle, {\n        variant: \"success\",\n        id: \"dropdown-basic\",\n        children: device.selectedDevice.name || \"Выберите устройство\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Dropdown.Menu, {\n        children: Array.isArray(device.devices) && device.devices.map(deviceItem => /*#__PURE__*/_jsxDEV(Dropdown.Item, {\n          onClick: () => device.setSelectedDevice(deviceItem),\n          children: deviceItem.name\n        }, deviceItem.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal.Footer, {\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        variant: \"outline-danger\",\n        onClick: onHide,\n        children: \"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"outline-success\",\n        onClick: handleGetStatistics,\n        children: \"\\u041F\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440\\u0435\\u0442\\u044C \\u0441\\u0442\\u0430\\u0442\\u0438\\u0441\\u0442\\u0438\\u043A\\u0443\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: Object.keys(statistics).map(questionIndex => {\n        var _device$selectedDevic;\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: ((_device$selectedDevic = device.selectedDevice.info[questionIndex]) === null || _device$selectedDevic === void 0 ? void 0 : _device$selectedDevic.title) || `Вопрос ${parseInt(questionIndex) + 1}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 13\n          }, this), statistics[questionIndex].map((stat, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [\"- \\u041F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044C \", stat.user, \": \", stat.answer]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 15\n          }, this))]\n        }, questionIndex, true, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 11\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 5\n  }, this);\n};\n_s(GetResults, \"O/JYDjjIi0HQOEnlA0c8Qfx7KSw=\");\n_c = GetResults;\nexport default GetResults;\nvar _c;\n$RefreshReg$(_c, \"GetResults\");","map":{"version":3,"names":["React","useContext","useEffect","useState","Modal","Dropdown","Button","axios","Context","jsxDEV","_jsxDEV","GetResults","show","onHide","_s","results","setResults","statistics","setStatistics","device","selectedDevice","id","get","then","response","filteredResults","data","filter","result","deviceId","console","log","catch","error","setDevices","getStatistics","stats","Array","isArray","forEach","answers","Object","keys","index","answer","singleAnswer","push","user","userId","replace","warn","handleGetStatistics","children","Toggle","variant","name","fileName","_jsxFileName","lineNumber","columnNumber","Menu","devices","map","deviceItem","Item","onClick","setSelectedDevice","Footer","questionIndex","_device$selectedDevic","info","title","parseInt","stat","_c","$RefreshReg$"],"sources":["C:/Users/butabayev.yerali/Documents/GitHub/er17/client/src/components/modals/GetResults.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\r\nimport { Modal, Dropdown, Button } from 'react-bootstrap';\r\nimport axios from 'axios';\r\nimport { Context } from '../..';\r\n\r\nconst GetResults = ({ show, onHide }) => {\r\n  const [results, setResults] = useState([]);\r\n  const [statistics, setStatistics] = useState({});\r\n  const { device } = useContext(Context);\r\n\r\n  useEffect(() => {\r\n    if (device.selectedDevice.id) {\r\n      axios.get(`http://localhost:5000/api/testResult?deviceId=${device.selectedDevice.id}`)\r\n        .then(response => {\r\n          const filteredResults = response.data.filter(result => result.deviceId === device.selectedDevice.id);\r\n          console.log('Filtered Results:', filteredResults);\r\n          setResults(filteredResults);\r\n        })\r\n        .catch(error => {\r\n          console.error('There was an error fetching the survey results!', error);\r\n        });\r\n    }\r\n  }, [device.selectedDevice]);\r\n\r\n  useEffect(() => {\r\n    axios.get('http://localhost:5000/api/device')\r\n      .then(response => {\r\n        device.setDevices(response.data);\r\n      })\r\n      .catch(error => {\r\n        console.error('There was an error fetching the devices!', error);\r\n      });\r\n  }, []);\r\n\r\n  const getStatistics = () => {\r\n    const stats = {};\r\n\r\n    if (results && Array.isArray(results)) {\r\n      results.forEach(result => {\r\n        console.log('Processing result:', result);\r\n        if (result.answers && typeof result.answers === 'object') {\r\n          Object.keys(result.answers).forEach((index) => {\r\n            const answer = result.answers[index];\r\n            if (!stats[index]) {\r\n              stats[index] = [];\r\n            }\r\n            if (Array.isArray(answer)) {\r\n              answer.forEach(singleAnswer => {\r\n                stats[index].push({ user: result.userId, answer: `Вариант ответа ${singleAnswer.replace('description', '')}` });\r\n              });\r\n            } else {\r\n              stats[index].push({ user: result.userId, answer: `Вариант ответа ${answer.replace('description', '')}` });\r\n            }\r\n          });\r\n        } else {\r\n          console.warn('Missing or invalid answers for result:', result);\r\n        }\r\n      });\r\n    }\r\n\r\n    console.log('Calculated Statistics:', stats);\r\n    setStatistics(stats);\r\n  };\r\n\r\n  const handleGetStatistics = () => {\r\n    getStatistics();\r\n  };\r\n\r\n  useEffect(() => {\r\n    console.log('Statistics:', statistics);\r\n  }, [statistics]);\r\n\r\n  return (\r\n    <Modal show={show} onHide={onHide}>\r\n      <Dropdown>\r\n        <Dropdown.Toggle variant=\"success\" id=\"dropdown-basic\">\r\n          {device.selectedDevice.name || \"Выберите устройство\"}\r\n        </Dropdown.Toggle>\r\n        <Dropdown.Menu>\r\n          {Array.isArray(device.devices) && device.devices.map(deviceItem =>\r\n            <Dropdown.Item\r\n              onClick={() => device.setSelectedDevice(deviceItem)}\r\n              key={deviceItem.id}\r\n            >\r\n              {deviceItem.name}\r\n            </Dropdown.Item>\r\n          )}\r\n        </Dropdown.Menu>\r\n      </Dropdown>\r\n      <Modal.Footer>\r\n        <Button variant=\"outline-danger\" onClick={onHide}>Закрыть</Button>\r\n        <Button variant=\"outline-success\" onClick={handleGetStatistics}>Посмотреть статистику</Button>\r\n      </Modal.Footer>\r\n      <div>\r\n        {Object.keys(statistics).map(questionIndex => (\r\n          <div key={questionIndex}>\r\n            <h3>{device.selectedDevice.info[questionIndex]?.title || `Вопрос ${parseInt(questionIndex) + 1}`}</h3>\r\n            {statistics[questionIndex].map((stat, index) => (\r\n              <div key={index}>\r\n                - Пользователь {stat.user}: {stat.answer}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default GetResults;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}